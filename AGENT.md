# AGENT Playbook for TODO-React-Typescript

このドキュメントは、このリポジトリで私（エージェント）が自律的に実行する既定オペレーションをまとめたものです。以後、明示的な指示がなくても本書の内容を標準フローとして遂行します。

## 目的

- 作業手順の標準化と抜け漏れ防止
- 小さな変更 → 即型チェック → 粒度の良いコミットの徹底
- 既存の UX/保存ポリシー（モーダル閉鎖時に保存）への一貫性維持

## デフォルト運用フロー

1. 変更範囲の把握と最小タスクリストを作成（`update_plan`を使用）。
2. `apply_patch`で小さく変更。
3. 変更のたびに必ず型チェックを実行：`npm run -s typecheck`。
4. エラーが出たら即修正（未使用・型不一致・破壊的変更の波及を優先修正）。
5. 粒度の良いコミットを作成（後述の規約）。
6. 仕様が揺れる場合は既存パターン（本書の「リポジトリ特有の約束」）を優先。

## 型チェック（自動実行）

- 以後、型チェックの実行は常に `npm run -s typecheck` を使用（スクリプトの中身は `package.json` を参照）。
- `.ts`/`.tsx` の変更を伴うパッチ適用後は毎回 `npm run -s typecheck` を自動実行。
  - 実行できない環境（サンドボックス等）の場合は、その旨を通知し修正は継続。

## コミット規約（粒度とメッセージ）

- 1 コミット＝ 1 意図（UI 導線変更／VM 状態追加／型修正／バグ修正など）。
- 推奨 prefix：`feat`, `fix`, `refactor`, `chore`, `docs`。
- 例：
  - `feat(todo): 編集アイコンで詳細モーダルを開く`
  - `feat(modal): 名前編集モードを追加し、閉鎖時に保存`
  - `fix(modal): optional destructuringの構文修正とonBlur型整合`
  - `refactor(todo): インライン編集のデッドコード削除`

## PR コメントへの対応

- PR リンクが与えられた場合：
  - ネットワーク利用可ならコメントを取得 → 要点を箇条書き化 → 修正計画 → 実装 → 再チェック。
  - ネットワーク制限時は、コメントの抜粋を貼ってもらう or 主要指摘を要約してもらうよう依頼。
- 対応後は、どのコメントにどう対応したかを簡潔に記録。

## 毎回のチェックリスト

- [ ] 変更前にタスクを分解し`update_plan`で共有
- [ ] `apply_patch`で小さく安全に変更
- [ ] 直後に `npm run -s typecheck`（失敗したら即修正）
- [ ] 新規 props は型・呼び出し側すべて整合
- [ ] 既存パターン（モーダル閉鎖時保存・編集トリガ）に合わせる
- [ ] デッドコードや未使用の破片を残さない
- [ ] 粒度の良いコミットメッセージで履歴を残す

## 付記

- ここに追記された規約は今後の既定動作として扱います。新たな学びがあれば本書を更新します。
